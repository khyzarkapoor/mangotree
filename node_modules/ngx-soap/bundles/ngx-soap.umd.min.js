!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("sax"),require("url"),require("assert"),require("lodash"),require("buffer"),require("events"),require("util"),require("uuid/v4"),require("rxjs/operators"),require("@angular/core"),require("@angular/common/http")):"function"==typeof define&&define.amd?define("ngx-soap",["exports","sax","url","assert","lodash","buffer","events","util","uuid/v4","rxjs/operators","@angular/core","@angular/common/http"],t):t(e["ngx-soap"]={},null,null,null,null,null,null,null,null,e.rxjs.operators,e.ng.core,e.ng.common.http)}(this,function(e,s,c,N,O,t,i,n,j,C,o,r){"use strict";function a(t,r,a,p){return new(a||(a=Promise))(function(e,n){function i(e){try{o(p.next(e))}catch(t){n(t)}}function s(e){try{o(p["throw"](e))}catch(t){n(t)}}function o(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(i,s)}o((p=p.apply(t,r||[])).next())})}function l(n,i){var s,o,r,e,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return e={next:t(0),"throw":t(1),"return":t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(e){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,o&&(r=2&e[0]?o["return"]:e[0]?o["throw"]||((r=o["return"])&&r.call(o),0):o.next)&&!(r=r.call(o,e[1])).done)return r;switch(o=0,r&&(e=[2&e[0],r.value]),e[0]){case 0:case 1:r=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(r=0<(r=a.trys).length&&r[r.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!r||e[1]>r[0]&&e[1]<r[3])){a.label=e[1];break}if(6===e[0]&&a.label<r[1]){a.label=r[1],r=e;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(e);break}r[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(n,a)}catch(t){e=[6,t],o=0}finally{s=r=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([t,e])}}}j=j&&j.hasOwnProperty("default")?j["default"]:j;var p=function u(e){if(this.getNamespaceURI=function(e,t){switch(e){case"xml":return"http://www.w3.org/XML/1998/namespace";case"xmlns":return"http://www.w3.org/2000/xmlns/";default:var n=this.namespaces[e];return null!=n?n.uri:!t&&this.parent?this.parent.getNamespaceURI(e):null}},this.getNamespaceMapping=function(e){switch(e){case"xml":return{uri:"http://www.w3.org/XML/1998/namespace",prefix:"xml",declared:!0};case"xmlns":return{uri:"http://www.w3.org/2000/xmlns/",prefix:"xmlns",declared:!0};default:var t=this.namespaces[e];return null!=t?t:this.parent?this.parent.getNamespaceMapping(e):null}},this.getPrefix=function(e,t){switch(e){case"http://www.w3.org/XML/1998/namespace":return"xml";case"http://www.w3.org/2000/xmlns/":return"xmlns";default:for(var n in this.namespaces)if(this.namespaces[n].uri===e)return n;return!t&&this.parent?this.parent.getPrefix(e):null}},!(this instanceof u))return new u(e);this.parent=e,this.namespaces={}},q=function h(){if(this.addNamespace=function(e,t,n){return this.getNamespaceURI(e,n)!==t&&!!this.currentScope&&(this.currentScope.namespaces[e]={uri:t,prefix:e,declared:!1},!0)},this.pushContext=function(){var e=new p(this.currentScope);return this.scopes.push(e),this.currentScope=e},this.popContext=function(){var e=this.scopes.pop();return this.currentScope=e?e.parent:null,e},this.getNamespaceURI=function(e,t){return this.currentScope&&this.currentScope.getNamespaceURI(e,t)},this.getPrefix=function(e,t){return this.currentScope&&this.currentScope.getPrefix(e,t)},this.registerNamespace=function(e){var t=this.getPrefix(e);if(t)return t;for(;t="ns"+ ++this.prefixCount,this.getNamespaceURI(t););return this.addNamespace(t,e,!0),t},this.declareNamespace=function(e,t){if(this.currentScope){var n=this.currentScope.getNamespaceMapping(e);return!(n&&n.uri===t&&n.declared||(this.currentScope.namespaces[e]={uri:t,prefix:e,declared:!0},0))}return!1},!(this instanceof h))return new h;this.scopes=[],this.pushContext(),this.prefixCount=0},d="__tns__",A=function(e,t){for(var n in e)if(n!==d&&e[n]===t)return n},B=d,f=A,y={string:1,"boolean":1,decimal:1,"float":1,"double":1,anyType:1,"byte":1,"int":1,"long":1,"short":1,negativeInteger:1,nonNegativeInteger:1,positiveInteger:1,nonPositiveInteger:1,unsignedByte:1,unsignedInt:1,unsignedLong:1,unsignedShort:1,duration:0,dateTime:0,time:0,date:0,gYearMonth:0,gYear:0,gMonthDay:0,gDay:0,gMonth:0,hexBinary:0,base64Binary:0,anyURI:0,QName:0,NOTATION:0};function D(e){var t="string"==typeof e?e.indexOf(":"):-1;return t<0?{prefix:B,name:e}:{prefix:e.substring(0,t),name:e.substring(t+1)}}function z(e){return"string"==typeof e?"<![CDATA["===e.substr(0,9)&&"]]>"===e.substr(-3)?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}var m=/^[\s\xA0]+/,v=/[\s\xA0]+$/;function g(e){return e.replace(m,"").replace(v,"")}var x=function(e,t,n){var i=D(e);for(var s in this.nsName=e,this.prefix=i.prefix,this.name=i.name,this.children=[],this.xmlns={},this._initializeOptions(n),t){var o=/^xmlns:?(.*)$/.exec(s);o?this.xmlns[o[1]?o[1]:B]=t[s]:"value"===s?this[this.valueKey]=t[s]:this["$"+s]=t[s]}this.$targetNamespace!==undefined&&(this.xmlns[B]=this.$targetNamespace)};x.prototype._initializeOptions=function(e){e?(this.valueKey=e.valueKey||"$value",this.xmlKey=e.xmlKey||"$xml",this.ignoredNamespaces=e.ignoredNamespaces||[]):(this.valueKey="$value",this.xmlKey="$xml",this.ignoredNamespaces=[])},x.prototype.deleteFixedAttrs=function(){this.children&&0===this.children.length&&delete this.children,this.xmlns&&0===Object.keys(this.xmlns).length&&delete this.xmlns,delete this.nsName,delete this.prefix,delete this.name},x.prototype.allowedChildren=[],x.prototype.startElement=function(e,t,n,i){if(this.allowedChildren){var s=this.allowedChildren[D(t).name];s?e.push(new s(t,n,i)):this.unexpected(t)}},x.prototype.endElement=function(e,t){if(this.nsName===t){if(e.length<2)return;var n=e[e.length-2];this!==e[0]&&(O.defaultsDeep(e[0].xmlns,this.xmlns),n.children.push(this),n.addChild(this)),e.pop()}},x.prototype.addChild=function(e){},x.prototype.unexpected=function(e){throw new Error("Found unexpected element ("+e+") inside "+this.nsName)},x.prototype.description=function(e){return this.$name||this.name},x.prototype.init=function(){},x.createSubClass=function(){var e=this,t=function(){e.apply(this,arguments),this.init()};return t.prototype.__proto__=e.prototype,t};var b=x.createSubClass(),$=x.createSubClass(),S=x.createSubClass(),w=x.createSubClass(),_=x.createSubClass(),T=x.createSubClass(),E=x.createSubClass(),H=x.createSubClass(),L=x.createSubClass(),P=x.createSubClass(),M=x.createSubClass(),k=x.createSubClass(),I=x.createSubClass(),K=x.createSubClass(),R=x.createSubClass(),X=x.createSubClass(),F=x.createSubClass(),W=x.createSubClass(),U=x.createSubClass(),Y=x.createSubClass(),G=x.createSubClass(),J=x.createSubClass(),Q=x.createSubClass(),V=x.createSubClass(),Z={types:[W,"schema documentation"],schema:[F,"element complexType simpleType include import"],element:[b,"annotation complexType"],any:[$,""],simpleType:[_,"restriction"],restriction:[T,"enumeration all choice sequence"],extension:[E,"all sequence choice"],choice:[H,"element sequence choice any"],enumeration:[L,""],complexType:[P,"annotation sequence all complexContent simpleContent choice"],complexContent:[M,"extension"],simpleContent:[k,"extension"],sequence:[I,"element sequence choice any"],all:[K,"element choice"],service:[Q,"port documentation"],port:[J,"address documentation"],binding:[G,"_binding SecuritySpec operation documentation"],portType:[Y,"operation documentation"],message:[R,"part documentation"],operation:[U,"documentation input output fault _operation"],input:[S,"body SecuritySpecRef documentation header"],output:[w,"body SecuritySpecRef documentation header"],fault:[x,"_fault documentation"],definitions:[V,"types message portType binding service import documentation"],documentation:[X,""]};function ee(e){var t={};return(e=e.split(" ")).forEach(function(e){t[e.replace(/^_/,"")]=(Z[e]||[x])[0]}),t}for(var te in Z){var ne=Z[te];ne[0].prototype.allowedChildren=ee(ne[1])}R.prototype.init=function(){this.element=null,this.parts=null},F.prototype.init=function(){this.complexTypes={},this.types={},this.elements={},this.includes=[]},W.prototype.init=function(){this.schemas={}},U.prototype.init=function(){this.input=null,this.output=null,this.inputSoap=null,this.outputSoap=null,this.style="",this.soapAction=""},Y.prototype.init=function(){this.methods={}},G.prototype.init=function(){this.transport="",this.style="",this.methods={}},J.prototype.init=function(){this.location=null},Q.prototype.init=function(){this.ports={}},V.prototype.init=function(){"definitions"!==this.name&&this.unexpected(this.nsName),this.messages={},this.portTypes={},this.bindings={},this.services={},this.schemas={}},X.prototype.init=function(){},F.prototype.merge=function(e){return N.ok(e instanceof F),this.$targetNamespace===e.$targetNamespace&&(O.merge(this.complexTypes,e.complexTypes),O.merge(this.types,e.types),O.merge(this.elements,e.elements),O.merge(this.xmlns,e.xmlns)),this},F.prototype.addChild=function(e){if(!(e.$name in y)){if("include"===e.name||"import"===e.name){var t=e.$schemaLocation||e.$location;t&&this.includes.push({namespace:e.$namespace||e.$targetNamespace||this.$targetNamespace,location:t})}else"complexType"===e.name?this.complexTypes[e.$name]=e:"element"===e.name?this.elements[e.$name]=e:e.$name&&(this.types[e.$name]=e);this.children.pop()}},W.prototype.addChild=function(e){N.ok(e instanceof F);var t=e.$targetNamespace;this.schemas.hasOwnProperty(t)?console.error('Target-Namespace "'+t+'" already in use by another Schema!'):this.schemas[t]=e},S.prototype.addChild=function(e){"body"===e.name&&(this.use=e.$use,"encoded"===this.use&&(this.encodingStyle=e.$encodingStyle),this.children.pop())},w.prototype.addChild=function(e){"body"===e.name&&(this.use=e.$use,"encoded"===this.use&&(this.encodingStyle=e.$encodingStyle),this.children.pop())},U.prototype.addChild=function(e){"operation"===e.name&&(this.soapAction=e.$soapAction||"",this.style=e.$style||"",this.children.pop())},G.prototype.addChild=function(e){"binding"===e.name&&(this.transport=e.$transport,this.style=e.$style,this.children.pop())},J.prototype.addChild=function(e){"address"===e.name&&"undefined"!=typeof e.$location&&(this.location=e.$location)},V.prototype.addChild=function(e){var t=this;e instanceof W?O.merge(t.schemas,e.schemas):e instanceof R?t.messages[e.$name]=e:"import"===e.name?(t.schemas[e.$namespace]=new F(e.$namespace,{}),t.schemas[e.$namespace].addChild(e)):e instanceof Y?t.portTypes[e.$name]=e:e instanceof G?"http://schemas.xmlsoap.org/soap/http"!==e.transport&&"http://www.w3.org/2003/05/soap/bindings/HTTP/"!==e.transport||(t.bindings[e.$name]=e):e instanceof Q&&(t.services[e.$name]=e),this.children.pop()},R.prototype.postProcess=function(e){var t=null,n=undefined,i=this.children||[],s=undefined,o=undefined,r=undefined,a=undefined;for(r in i)if("part"===(n=i[r]).name){t=n;break}if(t){if(t.$element){var p,c=[];delete this.parts,s=(o=D(t.$element)).prefix;var l=e.schemas[e.xmlns[s]];if(this.element=l.elements[o.name],!this.element)return;if(this.element.targetNSAlias=s,this.element.targetNamespace=e.xmlns[s],this.element.$lookupType=t.$element,0<(p=this.element.children).length)for(r=0;r<p.length;r++)c.push(this._getNestedLookupTypeString(p[r]));if(0<c.length){c=c.join("_").split("_").filter(function(e){return"^"!==e});var u=e.schemas[this.element.targetNamespace].xmlns;for(r=0;r<c.length;r++)c[r]=this._createLookupTypeObject(c[r],u)}if(this.element.$lookupTypes=c,this.element.$type){a=D(this.element.$type);var h=l.xmlns&&l.xmlns[a.prefix]||e.xmlns[a.prefix];if(h)if(a.name in y);else{var d=(l=e.schemas[h]).complexTypes[a.name]||l.types[a.name]||l.elements[a.name];d&&(this.parts=d.description(e,l.xmlns))}}else{var f=this.element.description(e,l.xmlns);this.parts=f[o.name]}this.children.splice(0,1)}else for(this.parts={},delete this.element,r=0;t=this.children[r];r++)if("documentation"!==t.name){N.ok("part"===t.name,"Expected part element"),o=D(t.$type),s=e.xmlns[o.prefix],a=o.name;var m=e.schemas[s];this.parts[t.$name]=void 0!==m?e.schemas[s].types[a]||e.schemas[s].complexTypes[a]:t.$type,"object"==typeof this.parts[t.$name]&&(this.parts[t.$name].prefix=o.prefix,this.parts[t.$name].xmlns=s),this.children.splice(r--,1)}this.deleteFixedAttrs()}},R.prototype._createLookupTypeObject=function(e,t){var n=D(e),i=n.prefix,s=n.name.split("#"),o=s[0],r=s[1],a={};return a.$namespace=t[i],a.$type=i+":"+o,a.$name=r,a},R.prototype._getNestedLookupTypeString=function(e){var n="^",t=this.ignoredNamespaces.concat("xs");if(e.hasOwnProperty("$type")&&"string"==typeof e.$type&&-1===t.indexOf(e.$type.split(":")[0])&&(n+="_"+e.$type+"#"+e.$name),0<e.children.length){var i=this;e.children.forEach(function(e){var t=i._getNestedLookupTypeString(e).replace(/\^_/,"");t&&"string"==typeof t&&(n+="_"+t)})}return n},U.prototype.postProcess=function(e,t){for(var n=this.children,i=0,s=void 0;s=n[i];i++)if("input"===s.name||"output"===s.name)if("binding"!==t){var o=D(s.$message).name,r=e.messages[o];r.postProcess(e),r.element?(e.messages[r.element.$name]=r,this[s.name]=r.element):this[s.name]=r,n.splice(i--,1)}else this[s.name]=s,n.splice(i--,1);this.deleteFixedAttrs()},Y.prototype.postProcess=function(e){var t=this.children;if(void 0!==t){for(var n=0,i=void 0;i=t[n];n++)"operation"===i.name&&(i.postProcess(e,"portType"),this.methods[i.$name]=i,t.splice(n--,1));delete this.$name,this.deleteFixedAttrs()}},G.prototype.postProcess=function(e){var t=D(this.$type).name,n=e.portTypes[t],i=this.style,s=this.children;if(n){n.postProcess(e),this.methods=n.methods;for(var o=0,r=void 0;r=s[o];o++)if("operation"===r.name){r.postProcess(e,"binding"),s.splice(o--,1),r.style||(r.style=i);var a=this.methods[r.$name];a&&(a.style=r.style,a.soapAction=r.soapAction,a.inputSoap=r.input||null,a.outputSoap=r.output||null,a.inputSoap&&a.inputSoap.deleteFixedAttrs(),a.outputSoap&&a.outputSoap.deleteFixedAttrs())}}delete this.$name,delete this.$type,this.deleteFixedAttrs()},Q.prototype.postProcess=function(e){var t=this.children,n=e.bindings;if(t&&0<t.length)for(var i=0,s=void 0;s=t[i];i++)if("port"===s.name){var o=n[D(s.$binding).name];o&&(o.postProcess(e),this.ports[s.$name]={location:s.location,binding:o},t.splice(i--,1))}delete this.$name,this.deleteFixedAttrs()},_.prototype.description=function(e){for(var t=this.children,n=0,i=void 0;i=t[n];n++)if(i instanceof T)return this.$name+"|"+i.description();return{}},T.prototype.description=function(e,t){for(var n,i=this.children,s=0,o=void 0;o=i[s];s++)if(o instanceof I||o instanceof H){n=o.description(e,t);break}if(n&&this.$base){var r=D(this.$base),a=r.name,p=t&&t[r.prefix]||e.xmlns[r.prefix],c=e.schemas[p],l=c&&(c.complexTypes[a]||c.types[a]||c.elements[a]);return n.getBase=function(){return l.description(e,c.xmlns)},n}return(this.$base?this.$base+"|":"")+this.children.map(function(e){return e.description()}).join(",")},E.prototype.description=function(e,t){for(var n=this.children,i={},s=0,o=void 0;o=n[s];s++)(o instanceof I||o instanceof H)&&(i=o.description(e,t));if(this.$base){var r=D(this.$base),a=r.name,p=t&&t[r.prefix]||e.xmlns[r.prefix],c=e.schemas[p];if(a in y)return this.$base;var l=c&&(c.complexTypes[a]||c.types[a]||c.elements[a]);if(l){var u=l.description(e,c.xmlns);i=O.defaultsDeep(u,i)}}return i},L.prototype.description=function(){return this[this.valueKey]},P.prototype.description=function(e,t){for(var n=this.children||[],i=0,s=void 0;s=n[i];i++)if(s instanceof H||s instanceof I||s instanceof K||s instanceof k||s instanceof M)return s.description(e,t);return{}},M.prototype.description=function(e,t){for(var n=this.children,i=0,s=void 0;s=n[i];i++)if(s instanceof E)return s.description(e,t);return{}},k.prototype.description=function(e,t){for(var n=this.children,i=0,s=void 0;s=n[i];i++)if(s instanceof E)return s.description(e,t);return{}},b.prototype.description=function(e,t){var n={},i=this.$name,s=!!this.$maxOccurs&&(isNaN(this.$maxOccurs)?"unbounded"===this.$maxOccurs:1<this.$maxOccurs);this.$minOccurs!==this.$maxOccurs&&s&&(i+="[]"),t&&t[B]&&(this.$targetNamespace=t[B]);var o=this.$type||this.$ref;if(o){var r=(o=D(o)).name,a=t&&t[o.prefix]||e.xmlns[o.prefix],p=e.schemas[a],c=p&&(this.$type?p.complexTypes[r]||p.types[r]:p.elements[r]);if(a&&e.schemas[a]&&(t=e.schemas[a].xmlns),!c||r in y)n[i]=this.$type;else if(r in e.descriptions.types)this.$ref?n=e.descriptions.types[r]:n[i]=e.descriptions.types[r];else{var l={};e.descriptions.types[r]=l;var u=c.description(e,t);"string"==typeof u?l=u:Object.keys(u).forEach(function(e){l[e]=u[e]}),this.$ref?n=l:n[i]=l,"object"==typeof l&&(l.targetNSAlias=o.prefix,l.targetNamespace=a),e.descriptions.types[r]=l}}else{var h=this.children;n[i]={};for(var d=0,f=void 0;f=h[d];d++)f instanceof P&&(n[i]=f.description(e,t))}return n},K.prototype.description=I.prototype.description=function(e,t){for(var n=this.children,i={},s=0,o=void 0;o=n[s];s++)if(!(o instanceof $)){var r=o.description(e,t);for(var a in r)i[a]=r[a]}return i},H.prototype.description=function(e,t){for(var n=this.children,i={},s=0,o=void 0;o=n[s];s++){var r=o.description(e,t);for(var a in r)i[a]=r[a]}return i},R.prototype.description=function(e){if(this.element)return this.element&&this.element.description(e);var t={};return t[this.$name]=this.parts,t},Y.prototype.description=function(e){var t={};for(var n in this.methods){var i=this.methods[n];t[n]=i.description(e)}return t},U.prototype.description=function(e){var t=this.input?this.input.description(e):null,n=this.output?this.output.description(e):null;return{input:t&&t[Object.keys(t)[0]],output:n&&n[Object.keys(n)[0]]}},G.prototype.description=function(e){var t={};for(var n in this.methods){var i=this.methods[n];t[n]=i.description(e)}return t},Q.prototype.description=function(e){var t={};for(var n in this.ports){var i=this.ports[n];t[n]=i.binding.description(e)}return t};var ie=function(t,e,n){var i,s,h=this;if(this.uri=e,this.callback=function(){},this._includesWsdl=[],this.WSDL_CACHE=(n||{}).WSDL_CACHE||{},this._initializeOptions(n),"string"==typeof t)t=65279===(s=t).charCodeAt(0)?s.slice(1):s,i=this._fromXML;else{if("object"!=typeof t)throw new Error("WSDL letructor takes either an XML string or service definition");i=this._fromServices}Promise.resolve(!0).then(function(){try{i.call(h,t)}catch(e){return h.callback(e.message)}h.processIncludes().then(function(){h.definitions.deleteFixedAttrs();var e=h.services=h.definitions.services;if(e)for(var t in e)e[t].postProcess(h.definitions);var n=h.definitions.complexTypes;if(n)for(var i in n)n[i].deleteFixedAttrs();var s=h.definitions.bindings;for(var o in s){var r=s[o];if("undefined"==typeof r.style&&(r.style="document"),"document"===r.style){var a=r.methods,p=r.topElements={};for(var c in a)if(a[c].input){var l=a[c].input.$name,u="";a[c].output&&(u=a[c].output.$name),p[l]={methodName:c,outputName:u}}}}h.xmlnsInEnvelope=h._xmlnsMap(),h.callback(null,h)})["catch"](function(e){return h.callback(e)})})};function se(e){return e&&":"!==e.charAt(e.length-1)?e+":":e}function oe(e){return e&&":"===e.charAt(e.length-1)?e.substring(0,e.length-1):e}function re(s,o){return a(this,void 0,void 0,function(){var n,i,t;return l(this,function(e){switch(e.label){case 0:return n=o.WSDL_CACHE||{},o.wsdl_headers,o.wsdl_options,console.log("Reading url: %s",s),[4,o.httpClient.get(s,{responseType:"text"}).toPromise()];case 1:return i=e.sent(),[4,new Promise(function(e){var t=new ie(i,s,o);(n[s]=t).WSDL_CACHE=n,t.onReady(e(t))})];case 2:return t=e.sent(),console.log("wsdl",t),[2,t]}})})}ie.prototype.ignoredNamespaces=["tns","targetNamespace","typedNamespace"],ie.prototype.ignoreBaseNameSpaces=!1,ie.prototype.valueKey="$value",ie.prototype.xmlKey="$xml",ie.prototype._initializeOptions=function(e){this._originalIgnoredNamespaces=(e||{}).ignoredNamespaces,this.options={};var t=e?e.ignoredNamespaces:null;t&&(Array.isArray(t.namespaces)||"string"==typeof t.namespaces)?t.override?this.options.ignoredNamespaces=t.namespaces:this.options.ignoredNamespaces=this.ignoredNamespaces.concat(t.namespaces):this.options.ignoredNamespaces=this.ignoredNamespaces,this.options.valueKey=e.valueKey||this.valueKey,this.options.xmlKey=e.xmlKey||this.xmlKey,e.escapeXML!==undefined?this.options.escapeXML=e.escapeXML:this.options.escapeXML=!0,e.returnFault!==undefined?this.options.returnFault=e.returnFault:this.options.returnFault=!1,this.options.handleNilAsNull=!!e.handleNilAsNull,e.namespaceArrayElements!==undefined?this.options.namespaceArrayElements=e.namespaceArrayElements:this.options.namespaceArrayElements=!0,this.options.wsdl_headers=e.wsdl_headers,this.options.wsdl_options=e.wsdl_options,e.httpClient&&(this.options.httpClient=e.httpClient),e.request&&(this.options.request=e.request);var n=e?e.ignoreBaseNameSpaces:null;this.options.ignoreBaseNameSpaces=null!=n?n:this.ignoreBaseNameSpaces,this.options.forceSoap12Headers=e.forceSoap12Headers,this.options.customDeserializer=e.customDeserializer,e.overrideRootElement!==undefined&&(this.options.overrideRootElement=e.overrideRootElement),this.options.useEmptyTag=!!e.useEmptyTag},ie.prototype.onReady=function(e){e&&(this.callback=e)},ie.prototype._processNextInclude=function(p){return a(this,void 0,void 0,function(){var i,s,o,r,a;return l(this,function(e){switch(e.label){case 0:return i=this,(s=p.shift())?((/^https?:/.test(i.uri)||/^https?:/.test(s.location))&&(r=c.resolve(i.uri||"",s.location)),(o=O.assign({},this.options)).ignoredNamespaces=this._originalIgnoredNamespaces||this.options.ignoredNamespaces,o.WSDL_CACHE=this.WSDL_CACHE,[4,function(e,t){var n,i;if(i=t.WSDL_CACHE,n=i[e])return n;return re(e,t)}(r,o)]):[2];case 1:return a=e.sent(),i._includesWsdl.push(a),a.definitions instanceof V?O.mergeWith(i.definitions,a.definitions,function(e,t){return e instanceof F?e.merge(t):undefined}):i.definitions.schemas[s.namespace||a.definitions.$targetNamespace]=(t=i.definitions.schemas[s.namespace||a.definitions.$targetNamespace],n=a.definitions,O.mergeWith(t||{},n,function(e,t){return O.isArray(e)?e.concat(t):undefined})),[2,i._processNextInclude(p)]}var t,n})})},ie.prototype.processIncludes=function(){return a(this,void 0,void 0,function(){var t,n,i,s;return l(this,function(e){for(i in t=this.definitions.schemas,n=[],t)s=t[i],n=n.concat(s.includes||[]);return[2,this._processNextInclude(n)]})})},ie.prototype.describeServices=function(){var e={};for(var t in this.services){var n=this.services[t];e[t]=n.description(this.definitions)}return e},ie.prototype.toXML=function(){return this.xml||""},ie.prototype.xmlToObject=function(e,n){var w,N=this,j="function"==typeof n?{}:s.parser(!0),C=null,p={},A=[{name:null,object:p,schema:{Envelope:{Header:{Security:{UsernameToken:{Username:"string",Password:"string"}}},Body:{Fault:{faultcode:"string",faultstring:"string",detail:"string"}}}}}],_={},T={};if(j.onopentag=function(e){var t,n,i=e.name,s=e.attributes,o=D(i).name,r=A[A.length-1],a=r.schema,p={},c=!1,l=!1,u={},h=o;if(!C&&"Body"===r.name&&"Fault"!==o){var d=N.definitions.messages[o];if(!d)try{var f=!1;/Response$/.test(o)?o=o.replace(/Response$/,""):/Request$/.test(o)?(f=!0,o=o.replace(/Request$/,"")):/Solicit$/.test(o)&&(f=!0,o=o.replace(/Solicit$/,""));var m=N.definitions.portTypes,y=m[Object.keys(m)[0]];o=f?y.methods[o].input.$name:y.methods[o].output.$name,d=N.definitions.messages[o],N.definitions.messages[h]=N.definitions.messages[o]}catch(S){N.options.returnFault&&j.onerror(S)}a=d.description(N.definitions),C=h}for(t in s.href&&(w=s.href.substr(1),T[w]||(T[w]={hrefs:[],obj:null}),T[w].hrefs.push({par:r.object,key:o,obj:u})),(w=s.id)&&(T[w]||(T[w]={hrefs:[],obj:null})),s)/^xmlns:|^xmlns$/.test(t)?_[D(t).name]=s[t]:(c=!0,p[t]=s[t]);for(t in p){var v=D(t);if("nil"===v.name&&"http://www.w3.org/2001/XMLSchema-instance"===_[v.prefix]&&p[t]&&("true"===p[t].toLowerCase()||"1"===p[t])){l=!0;break}}c&&(u[N.options.attributesKey]=p);var g=p["xsi:type"];if(g){var x=D(g),b=void 0;b=x.prefix===B?_[x.prefix]||_.xmlns:_[x.prefix];var $=N.findSchemaObject(b,x.name);$&&(n=$.description(N.definitions))}a&&a[o+"[]"]&&(o+="[]"),A.push({name:h,object:u,schema:n||a&&a[o],id:s.id,nil:l})},j.onclosetag=function(e){var t=A.pop(),n=t.object,i=A[A.length-1],s=i.object,o=i.schema,r=D(e).name;if("string"!=typeof t.schema||"string"!==t.schema&&"string"!==t.schema.split(":")[1]||"object"==typeof n&&0===Object.keys(n).length&&(n=t.object=""),!0===t.nil){if(!N.options.handleNilAsNull)return;n=null}O.isPlainObject(n)&&!Object.keys(n).length&&(n=null),o&&o[r+"[]"]?(s[r]||(s[r]=[]),s[r].push(n)):r in s?(Array.isArray(s[r])||(s[r]=[s[r]]),s[r].push(n)):s[r]=n,t.id&&(T[t.id].obj=n)},j.oncdata=function(e){var t=e;if((e=g(e)).length)if(/<\?xml[\s\S]+\?>/.test(e)){var n=A[A.length-1],i=N.xmlToObject(e);n.object[N.options.attributesKey]?n.object[N.options.valueKey]=i:n.object=i}else j.ontext(t)},j.onerror=function(e){throw j.resume(),{Fault:{faultcode:500,faultstring:"Invalid XML",detail:new Error(e).message,statusCode:500}}},j.ontext=function(e){var t=e;if((e=g(e)).length){var n,i=A[A.length-1],s=D(i.schema).name;N.options&&N.options.customDeserializer&&N.options.customDeserializer[s]?n=N.options.customDeserializer[s](e,i):"int"===s||"integer"===s?n=parseInt(e,10):"bool"===s||"boolean"===s?n="true"===e.toLowerCase()||"1"===e:"dateTime"===s||"date"===s?n=new Date(e):(N.options.preserveWhitespace&&(e=t),n="string"!=typeof i.object?e:i.object+e),i.object[N.options.attributesKey]?i.object[N.options.valueKey]=n:i.object=n}},"function"==typeof n){var t=s.createStream(!0);return t.on("opentag",j.onopentag),t.on("closetag",j.onclosetag),t.on("cdata",j.oncdata),t.on("text",j.ontext),void e.pipe(t).on("error",function(e){n(e)}).on("end",function(){var e;try{e=i()}catch(t){return n(t)}n(null,e)})}return j.write(e).close(),i();function i(){for(var e in T)for(var t=T[e],n=0;n<t.hrefs.length;n++)O.assign(t.hrefs[n].obj,t.obj);if(p.Envelope){var i=p.Envelope.Body;if(i&&i.Fault){var s=i.Fault.faultcode&&i.Fault.faultcode.$value,o=i.Fault.faultstring&&i.Fault.faultstring.$value,r=i.Fault.detail&&i.Fault.detail.$value;s=s||i.Fault.faultcode,o=o||i.Fault.faultstring,r=r||i.Fault.detail;var a=new Error(s+": "+o+(r?": "+r:""));throw a.root=p,a}return p.Envelope}return p}},ie.prototype.findSchemaObject=function(e,t){if(!e||!t)return null;var n=null;if(this.definitions.schemas){var i=this.definitions.schemas[e];i&&(-1!==t.indexOf(":")&&(t=t.substring(t.indexOf(":")+1,t.length)),n=i.complexTypes[t]||i.types[t]||i.elements[t])}return n},ie.prototype.objectToDocumentXML=function(e,t,n,i,s){if(t&&t._xml)return t._xml;var o={};o[e]=t;var r=s?this.findSchemaObject(i,s):null;return this.objectToXML(o,null,n,i,!0,null,r)},ie.prototype.objectToRpcXML=function(e,t,n,i,s){var o=[],r=this.definitions;for(var a in n=n||f(r.xmlns,i),i=i||r.xmlns[n],n=n===B?"":n+":",o.push(["<",n,e,">"].join("")),t)if(t.hasOwnProperty(a)&&"_xmlns"!==a){var p=t[a],c=(s?"":n)+a,l=[];if("object"==typeof p&&p.hasOwnProperty(this.options.attributesKey)){var u=p[this.options.attributesKey];for(var h in u)l.push(" "+h+'="'+u[h]+'"')}o.push(["<",c].concat(l).concat(">").join("")),o.push("object"==typeof p?this.objectToXML(p,a,n,i):z(p)),o.push(["</",c,">"].join(""))}return o.push(["</",n,e,">"].join("")),o.join("")},ie.prototype.isIgnoredNameSpace=function(e){return-1<this.options.ignoredNamespaces.indexOf(e)},ie.prototype.filterOutIgnoredNameSpace=function(e){var t=oe(e);return this.isIgnoredNameSpace(t)?"":t},ie.prototype.objectToXML=function(e,t,n,i,s,o,r,a){var p=this,c=this.definitions.schemas[i],l=n?n.parent:undefined;void 0!==l&&(n=n.current),l=oe(l),this.isIgnoredNameSpace(l)&&(l="");var u=!c,h=c&&"qualified"===c.$elementFormDefault,d=[],f=(n||h)&&n!==B,m="";i&&s&&(p.options.overrideRootElement&&p.options.overrideRootElement.xmlnsAttributes?p.options.overrideRootElement.xmlnsAttributes.forEach(function(e){m+=" "+e.name+'="'+e.value+'"'}):(f&&!this.isIgnoredNameSpace(n)&&(m+=" xmlns:"+n+'="'+i+'"'),(h||u)&&(m+=' xmlns="'+i+'"'))),a?a.pushContext():(a=new q).declareNamespace(n,i),!o||p.options.overrideRootElement&&p.options.overrideRootElement.xmlnsAttributes||(m=o);var y,v,g="";if(p.options.overrideRootElement&&s?g=p.options.overrideRootElement.namespace:f&&(h||s||u)&&!this.isIgnoredNameSpace(n)&&(g=n),Array.isArray(e))for(y=0,v=e.length;y<v;y++){var x=e[y],b=p.processAttributes(x,a),$=l||g,S=p.objectToXML(x,t,n,i,!1,null,r,a),w=["<",se($),t,b,m];""===S&&p.options.useEmptyTag?(w.push(" />"),d.push(w.join(""))):(w.push(">"),(p.options.namespaceArrayElements||0===y)&&d.push(w.join("")),d.push(S),(p.options.namespaceArrayElements||y===v-1)&&d.push(["</",se($),t,">"].join("")))}else if("object"==typeof e){for(t in e)if(e.hasOwnProperty(t)&&t!==p.options.attributesKey){if(t===p.options.xmlKey)return a.popContext(),e[t];if(t===p.options.valueKey)return a.popContext(),z(e[t]);var N=e[t];if(void 0!==N){var j=p.processAttributes(N,a),C="",A="",_=!1,T=/^([^:]+):([^:]+)$/.exec(t);if(T?(A=T[1]+":",t=T[2]):":"===t[0]&&(_=!0,t=t.substr(1)),s)C=p.objectToXML(N,t,n,i,!1,null,r,a);else if(p.definitions.schemas)if(c){var O=p.findChildSchemaObject(r,t);if(O&&(O.$type&&-1===O.$type.indexOf("xsd:")||O.$ref||O.$name)){var E="",H="",L=void 0,P="",M=O.$ref||O.$name;if(M){H=(M=D(M)).name,M.prefix===B?(L=O.$targetNamespace,E=a.registerNamespace(L),this.isIgnoredNameSpace(E)&&(E=n)):(E=M.prefix,this.isIgnoredNameSpace(E)&&(E=n),L=c.xmlns[E]||p.definitions.xmlns[E]);var k=!1;O.$name&&O.targetNamespace===undefined&&(k="unqualified"===O.$form||"qualified"!==O.$form&&"qualified"!==c.$elementFormDefault),k&&(E=""),L&&E&&a.declareNamespace(E,L)&&(m+=P=" xmlns:"+E+'="'+L+'"')}var I=void 0;if(O.$type){var K=D(O.$type),R=K.prefix,X=c.xmlns[R]||p.definitions.xmlns[R];"http://www.w3.org/2001/XMLSchema"!==(L=X)&&R!==B&&a.addNamespace(R,X),I=p.findSchemaType(K.name,X)||O}else I=p.findSchemaObject(L,H)||O;O.$baseNameSpace&&this.options.ignoreBaseNameSpaces&&(E=n,L=i),this.options.ignoreBaseNameSpaces&&(L=E=""),g=E,Array.isArray(N)?E={current:E,parent:g}:P=null,C=p.objectToXML(N,t,E,L,!1,P,I,a)}else if(e[p.options.attributesKey]&&e[p.options.attributesKey].xsi_type){p.findChildSchemaObject(e[p.options.attributesKey].xsi_type.type,e[p.options.attributesKey].xsi_type.xmlns);A=e[p.options.attributesKey].xsi_type.prefix,a.addNamespace(e[p.options.attributesKey].xsi_type.prefix,e[p.options.attributesKey].xsi_type.xmlns),C=p.objectToXML(N,t,e[p.options.attributesKey].xsi_type.prefix,e[p.options.attributesKey].xsi_type.xmlns,!1,null,null,a)}else Array.isArray(N)&&(t=A+t),C=p.objectToXML(N,t,n,i,!1,null,null,a)}else C=p.objectToXML(N,t,n,i,!1,null,null,a);g=oe(g),f&&!h&&s&&!p.options.overrideRootElement?g=n:this.isIgnoredNameSpace(g)&&(g="");var F=!C&&p.options.useEmptyTag;Array.isArray(N)||d.push(["<",_?"":se(A||g),t,j,m,null===N?' xsi:nil="true"':"",F?" />":">"].join("")),F||(d.push(C),Array.isArray(N)||d.push(["</",_?"":se(A||g),t,">"].join("")))}}}else e!==undefined&&d.push(p.options.escapeXML?z(e):e);return a.popContext(),d.join("")},ie.prototype.processAttributes=function(e,t){var n="";null===e&&(e=[]);var i=e[this.options.attributesKey];if(i&&i.xsi_type){var s=i.xsi_type,o=s.prefix||s.namespace;o?t.declareNamespace(o,s.xmlns):o=t.registerNamespace(s.xmlns),s.prefix=o}if(i)for(var r in i)if("xsi_type"!==r)n+=" "+r+'="'+z(i[r])+'"';else{var a=i[r];n+=' xsi:type="'+a.prefix+":"+a.type+'"',n+=" xmlns:"+a.prefix+'="'+a.xmlns+'"'}return n},ie.prototype.findSchemaType=function(e,t){if(!this.definitions.schemas||!e||!t)return null;var n=this.definitions.schemas[t];return n&&n.complexTypes?n.complexTypes[e]:null},ie.prototype.findChildSchemaObject=function(e,t,n){if(!e||!t)return null;if(n||(n=[]),0<=n.indexOf(e))return null;n=n.concat([e]);var i,s=null,o=0;if(Array.isArray(e.$lookupTypes)&&e.$lookupTypes.length){var r=e.$lookupTypes;for(o=0;o<r.length;o++){var a=r[o];if(a.$name===t){s=a;break}}}var p,c=e;if(c.$name===t&&"element"===c.name)return c;if(c.$ref&&D(c.$ref).name===t)return c;if(c.$type&&1===n.length){var l=D(c.$type);p=l.prefix===B?e.$targetNamespace:this.definitions.xmlns[l.prefix];var u=this.findSchemaType(l.name,p);if(u)return this.findChildSchemaObject(u,t,n)}if(c.children)for(o=0;(i=c.children[o])&&!(s=this.findChildSchemaObject(i,t,n));o++)if(i.$base){var h=D(i.$base),d=h.prefix===B?"":h.prefix;p=i.xmlns[h.prefix]||this.definitions.xmlns[h.prefix];var f=this.findSchemaType(h.name,p);if(f&&(s=this.findChildSchemaObject(f,t,n))){s.$baseNameSpace=d,s.$type=d+":"+t;break}}return s||c.$name!==t?s:c},ie.prototype._parse=function(e){var r=this,t=s.parser(!0),a=[],p=null,c=null,l=null,u=r.options;return t.onopentag=function(e){var t,n=e.name,i=e.attributes,s=a[a.length-1];if(s)try{s.startElement(a,n,i,u)}catch(o){if(r.options.strict)throw o;a.push(new x(n,i,u))}else if("definitions"===(t=D(n).name))p=new V(n,i,u),a.push(p);else{if("schema"!==t)throw new Error("Unexpected root element of WSDL or include");p=new V("definitions",{},{}),c=new W("types",{},{}),l=new F(n,i,u),c.addChild(l),p.addChild(c),a.push(l)}},t.onclosetag=function(e){var t=a[a.length-1];N.ok(t,"Unmatched close tag: "+e),t.endElement(a,e)},t.write(e).close(),p},ie.prototype._fromXML=function(e){this.definitions=this._parse(e),this.definitions.descriptions={types:{}},this.xml=e},ie.prototype._fromServices=function(e){},ie.prototype._xmlnsMap=function(){var e=this.definitions.xmlns,t="";for(var n in e)if(""!==n&&n!==B){var i=e[n];switch(i){case"http://xml.apache.org/xml-soap":case"http://schemas.xmlsoap.org/wsdl/":case"http://schemas.xmlsoap.org/wsdl/soap/":case"http://schemas.xmlsoap.org/wsdl/soap12/":case"http://schemas.xmlsoap.org/soap/encoding/":case"http://www.w3.org/2001/XMLSchema":continue}~i.indexOf("http://schemas.xmlsoap.org/")||~i.indexOf("http://www.w3.org/")||~i.indexOf("http://xml.apache.org/")||(t+=" xmlns:"+n+'="'+i+'"')}return t};var ae=/[^a-z$_0-9]/i,pe=function(e,t,n){i.EventEmitter.call(this),n=n||{},this.wsdl=e,this._initializeOptions(n),this._initializeServices(t),this.httpClient=n.httpClient;n.overridePromiseSuffix&&n.overridePromiseSuffix};function ce(s,o,r){return a(this,void 0,void 0,function(){var i;return l(this,function(e){switch(e.label){case 0:return void 0===o&&(o={}),console.log("createClient",o),r=o.endpoint||r,[4,(t=s,n=o,re(t,n))];case 1:return i=e.sent(),[2,new pe(i,r,o)]}var t,n})})}n.inherits(pe,i.EventEmitter),pe.prototype.addSoapHeader=function(e,t,n,i){return this.soapHeaders||(this.soapHeaders=[]),"object"==typeof e&&(e=this.wsdl.objectToXML(e,t,n,i,!0)),this.soapHeaders.push(e)-1},pe.prototype.changeSoapHeader=function(e,t,n,i,s){this.soapHeaders||(this.soapHeaders=[]),"object"==typeof t&&(t=this.wsdl.objectToXML(t,n,i,s,!0)),this.soapHeaders[e]=t},pe.prototype.getSoapHeaders=function(){return this.soapHeaders},pe.prototype.clearSoapHeaders=function(){this.soapHeaders=null},pe.prototype.addHttpHeader=function(e,t){this.httpHeaders||(this.httpHeaders={}),this.httpHeaders[e]=t},pe.prototype.getHttpHeaders=function(){return this.httpHeaders},pe.prototype.clearHttpHeaders=function(){this.httpHeaders={}},pe.prototype.addBodyAttribute=function(i,e,t,n){if(this.bodyAttributes||(this.bodyAttributes=[]),"object"==typeof i){var s="";Object.getOwnPropertyNames(i).forEach(function(e,t,n){s+=" "+e+'="'+i[e]+'"'}),i=s}" "!==i.substr(0,1)&&(i=" "+i),this.bodyAttributes.push(i)},pe.prototype.getBodyAttributes=function(){return this.bodyAttributes},pe.prototype.clearBodyAttributes=function(){this.bodyAttributes=null},pe.prototype.setEndpoint=function(e){this.endpoint=e,this._initializeServices(e)},pe.prototype.describe=function(){this.wsdl.definitions.types;return this.wsdl.describeServices()},pe.prototype.setSecurity=function(e){this.security=e},pe.prototype.setSOAPAction=function(e){this.SOAPAction=e},pe.prototype._initializeServices=function(e){var t=this.wsdl.definitions.services;for(var n in t)this[n]=this._defineService(t[n],e)},pe.prototype._initializeOptions=function(e){this.streamAllowed=e.stream,this.normalizeNames=e.normalizeNames,this.wsdl.options.attributesKey=e.attributesKey||"attributes",this.wsdl.options.envelopeKey=e.envelopeKey||"soap",this.wsdl.options.preserveWhitespace=!!e.preserveWhitespace,e.ignoredNamespaces!==undefined&&e.ignoredNamespaces.override!==undefined&&!0===e.ignoredNamespaces.override&&e.ignoredNamespaces.namespaces!==undefined&&(this.wsdl.options.ignoredNamespaces=e.ignoredNamespaces.namespaces),e.overrideRootElement!==undefined&&(this.wsdl.options.overrideRootElement=e.overrideRootElement),this.wsdl.options.forceSoap12Headers=!!e.forceSoap12Headers},pe.prototype._defineService=function(e,t){var n=e.ports,i={};for(var s in n)i[s]=this._definePort(n[s],t||n[s].location);return i},pe.prototype._definePort=function(e,t){var n=t,i=e.binding.methods,s={};for(var o in i){s[o]=this._defineMethod(i[o],n),this[this.normalizeNames?o.replace(ae,"_"):o]=s[o]}return s},pe.prototype._defineMethod=function(s,o){var r=this,a=null;return function(e,t,n,i){return"function"==typeof e?(t=e,e={}):"function"==typeof n?(a=t,t=n,n=a):"function"==typeof i&&(a=t,t=i,i=n,n=a),r._invoke(s,e,o,n,i)}},pe.prototype._invoke=function(e,t,n,i,s){var o=this,r=e.$name,a=e.input,p=e.output,c=e.style,l=this.wsdl.definitions,u=this.wsdl.options.envelopeKey,h=l.$targetNamespace,d="",f="",m=null,y=null,v=A(l.xmlns,h),g={"Content-Type":"text/xml; charset=utf-8"},x="xmlns:"+u+'="http://schemas.xmlsoap.org/soap/envelope/"';for(var b in this.wsdl.options.forceSoap12Headers&&(g["Content-Type"]="application/soap+xml; charset=utf-8",x="xmlns:"+u+'="http://www.w3.org/2003/05/soap-envelope"'),y=this.SOAPAction?this.SOAPAction:e.soapAction!==undefined&&null!==e.soapAction?e.soapAction:(h.lastIndexOf("/")!==h.length-1?h+"/":h)+r,this.wsdl.options.forceSoap12Headers||(g.SOAPAction='"'+y+'"'),i=i||{},this.httpHeaders)g[b]=this.httpHeaders[b];for(var $ in s)g[$]=s[$];o.security&&o.security.addHeaders&&o.security.addHeaders(g),o.security&&o.security.addOptions&&o.security.addOptions(i),"rpc"!==c||!a.parts&&"element"!==a.name&&null!==t?(N.ok(!c||"document"===c,"invalid message definition for rpc style binding"),f=o.wsdl.objectToDocumentXML(a.$name,t,a.targetNSAlias,a.targetNamespace,a.$type||a.$lookupType)):(N.ok(!c||"rpc"===c,"invalid message definition for document style binding"),f=o.wsdl.objectToRpcXML(r,t,v,h,"element"!==a.name),"encoded"===e.inputSoap&&(d='soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" ')),m='<?xml version="1.0" encoding="utf-8"?><'+u+":Envelope "+x+' xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" '+d+this.wsdl.xmlnsInEnvelope+">"+(o.soapHeaders||o.security?"<"+u+":Header>"+(o.soapHeaders?o.soapHeaders.join("\n"):"")+(o.security&&!o.security.postProcess?o.security.toXML():"")+"</"+u+":Header>":"")+"<"+u+":Body"+(o.bodyAttributes?o.bodyAttributes.join(" "):"")+(o.security&&o.security.postProcess?' Id="_0"':"")+">"+f+"</"+u+":Body></"+u+":Envelope>",o.security&&o.security.postProcess&&(m=o.security.postProcess(m,u)),i&&i.postProcess&&(m=i.postProcess(m)),o.lastMessage=f,o.lastRequest=m,o.lastEndpoint=n;var S=i.exchangeId||j();o.emit("message",f,S),o.emit("request",m,S);var w=function(e){try{return JSON.parse(e)}catch(t){return undefined}};return o.httpClient.post(n,m,{headers:g,responseType:"text",observe:"response"}).pipe(C.map(function(e){return o.lastResponse=e.body,o.lastResponseHeaders=e&&e.headers,o.emit("response",e.body,e,S),function(e,t){var n;try{n=o.wsdl.xmlToObject(e)}catch(s){if(!p||!p.$lookupTypes){var i=O.isObject(e)?e:w(e);if(i)return{err:null,response:t,responseBody:i,header:undefined,xml:m}}throw s.response=t,s.body=e,o.emit("soapError",s,S),s}return function(t,e,n){var i=null;if(!p)return{err:null,response:null,responseBody:e,header:t.Header,xml:m};if(!t.html&&!t.Body)return{err:null,obj:t,responseBody:e,header:t.Header,xml:m};if("object"!=typeof t.Body){var s=new Error("Cannot parse response");return s.response=n,s.body=e,{err:s,obj:t,responseBody:e,header:undefined,xml:m}}(i=t.Body[p.$name])||(i=t.Body[p.$name.replace(/(?:Out(?:put)?|Response)$/,"")]);i||["Response","Out","Output"].forEach(function(e){if(t.Body.hasOwnProperty(r+e))return i=t.Body[r+e]});return{err:null,result:i,responseBody:e,header:t.Header,xml:m}}(n,e,t)}(e.body,e)}))};var le=function(){function e(e){this.http=e,console.log("ngx-soap service")}return e.prototype.createClient=function(e,t,n){return void 0===t&&(t={}),t.httpClient=this.http,ce(e,t,n)},e.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:r.HttpClient}]},e.ngInjectableDef=o.defineInjectable({factory:function(){return new e(o.inject(r.HttpClient))},token:e,providedIn:"root"}),e}(),ue=function(){function e(){}return e.decorators=[{type:o.NgModule,args:[{imports:[r.HttpClientModule],exports:[]}]}],e}();e.NgxSoapService=le,e.NgxSoapModule=ue,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-soap.umd.min.js.map